{"version":3,"file":"edit.min.js","sources":["../../../../peerinst/static/peerinst/js/ajax.js","../../../../peerinst/static/peerinst/js/utils.js","_edit/index.js"],"sourcesContent":["\"use strict\";\n\nexport function getCsrfToken() {\n  return document\n    .getElementsByName(\"csrfmiddlewaretoken\")[0]\n    .getAttribute(\"value\");\n}\n\nexport function buildReq(data, method) {\n  if (method.toLowerCase() === \"get\") {\n    return {\n      method: method.toUpperCase(),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"X-CSRFToken\": getCsrfToken(),\n      },\n    };\n  } else if (method.toLowerCase() === \"post\") {\n    const body = data ? JSON.stringify(data) : \"\";\n    return {\n      method: method.toUpperCase(),\n      body: body,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"X-CSRFToken\": getCsrfToken(),\n      },\n    };\n  } else {\n    throw Error(`Method ${method} not implemented yet.`);\n  }\n}\n\nexport function updateAssignmentQuestionList(\n  url,\n  questionId,\n  assignmentIdentifier,\n) {\n  const token = getCsrfToken();\n  const data = {\n    question_id: questionId,\n    assignment_identifier: assignmentIdentifier,\n  };\n  const req = {\n    method: \"POST\",\n    body: JSON.stringify(data),\n    credentials: \"include\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      \"X-CSRFToken\": token,\n    },\n  };\n  fetch(url, req)\n    .then(function (resp) {\n      if (!resp.ok) {\n        console.log(resp);\n      } else {\n        // Manipulate DOM\n        const list = document.getElementById(\"question-list\");\n        const card = document.getElementById(questionId);\n        if ($.contains(list, card)) {\n          $(\"#\" + questionId).remove();\n        } else {\n          $(\"#\" + questionId)\n            .find($(\".update-questions-btn\"))\n            .html(\"delete\");\n          const q = $(\"#\" + questionId).detach();\n          q.appendTo($(\"#question-list\"));\n          $(\"#empty-assignment-list\").remove();\n          $(\".search-set\").each(function () {\n            $(this) // eslint-disable-line no-invalid-this\n              .find(\".filter-count\")\n              .empty()\n              .append($(this).find(\".mdc-card:visible\").length); // eslint-disable-line no-invalid-this,max-len\n          });\n          $(\".search-set\").each(function () {\n            $(this) // eslint-disable-line no-invalid-this\n              .find(\".filter-count-total\")\n              .empty()\n              .append($(this).find(\".mdc-card\").length); // eslint-disable-line no-invalid-this,max-len\n          });\n        }\n      }\n    })\n    .catch(function (err) {\n      console.log(err);\n    });\n}\n","// @flow\n\"use strict\";\n\nexport function clear(node: HTMLElement): HTMLElement {\n  while (node.hasChildNodes()) {\n    // $FlowFixMe\n    node.removeChild(node.lastChild);\n  }\n  return node;\n}\n\nexport function formatDatetime(datetime: Date): string {\n  return (\n    datetime.toLocaleString(\"en-ca\", { year: \"numeric\" }) +\n    \"-\" +\n    datetime.toLocaleString(\"en-ca\", { month: \"2-digit\" }) +\n    \"-\" +\n    datetime.toLocaleString(\"en-ca\", { day: \"2-digit\" }) +\n    \" \" +\n    datetime.toLocaleString(\"en-ca\", { hour: \"2-digit\", hour12: false }) +\n    \":\" +\n    datetime.toLocaleString(\"en-ca\", { minute: \"2-digit\" })\n  );\n}\n\nexport function createSvg(name: string, useSprite: boolean = true): Element {\n  const svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n  const use = document.createElementNS(\"http://www.w3.org/2000/svg\", \"use\");\n  use.setAttributeNS(\n    \"http://www.w3.org/1999/xlink\",\n    \"href\",\n    svgLink(name, useSprite),\n  );\n  svg.append(use);\n  return svg;\n}\n\nexport function svgLink(name: string, useSprite: boolean = true): string {\n  if (useSprite) {\n    return `#${name}`;\n  } else {\n    return (\n      window.location.protocol +\n      \"//\" +\n      window.location.host +\n      \"/static/peerinst/icons.svg#\" +\n      name\n    );\n  }\n}\n\nexport function showAlert(msg: string) {\n  const fullPageBox = document.createElement(\"div\");\n  fullPageBox.classList.add(\"alert-box__full-page\");\n  fullPageBox.addEventListener(\"click\", (event: MouseEvent) => {\n    event.stopPropagation();\n    fullPageBox.parentNode?.removeChild(fullPageBox);\n  });\n  document.body?.appendChild(fullPageBox);\n\n  const box = document.createElement(\"div\");\n  box.classList.add(\"alert-box__box\");\n  box.addEventListener(\"click\", (event: MouseEvent) =>\n    event.stopPropagation(),\n  );\n  fullPageBox.appendChild(box);\n\n  const span = document.createElement(\"span\");\n  span.classList.add(\"alert-box__msg\");\n  span.textContent = msg;\n  box.appendChild(span);\n\n  const ok = document.createElement(\"button\");\n  ok.classList.add(\"alert-box__btn\", \"mdc-button\", \"mdc-button--unelevated\");\n  ok.textContent = \"Ok\";\n  box.appendChild(ok);\n}\n\nexport function createElement(tag, text = \"\", attributes = {}) {\n  const elem = document.createElement(tag);\n  if (text) {\n    elem.textContent = text;\n  }\n  Object.entries(attributes).forEach(([key, val]) => {\n    elem.setAttribute(key, val);\n  });\n  return elem;\n}\n","import { buildReq } from \"../../../../../peerinst/static/peerinst/js/ajax.js\";\nimport { clear } from \"../../../../../peerinst/static/peerinst/js/utils.js\";\n\n/*********/\n/* model */\n/*********/\n\nlet model;\n\nfunction initModel(data) {\n  model = {\n    quality: {\n      pk: data.quality.pk,\n      qualityType: data.quality.quality_type,\n    },\n    next: data.next,\n    available: data.available.map((c) => ({\n      name: c.name,\n      fullName: c.full_name,\n      description: c.description,\n    })),\n    criterions: data.criterions,\n    urls: {\n      addCriterion: data.urls.add_criterion,\n      updateCriterion: data.urls.update_criterion,\n      removeCriterion: data.urls.remove_criterion,\n    },\n  };\n}\n\n/**********/\n/* update */\n/**********/\n\nfunction updateCriterionOption(event, option, criterion) {\n  const type = option.getAttribute(\"data-type\");\n  const name = option.getAttribute(\"name\");\n  let value;\n\n  if (type === \"CommaSepField\" || type === \"ManyToManyField\") {\n    option.querySelector(\".comma-sep-input--input\").setCustomValidity(\"\");\n    if (event.key === \"Enter\" || event.key === \",\" || event.key === \" \") {\n      if (value === \" \" || value === \",\") {\n        value = \"\";\n      }\n      value = option.querySelector(\".comma-sep-input--input\").value;\n      if (!value) {\n        event.preventDefault();\n        return;\n      }\n      if (criterion[name].allowed) {\n        if (!criterion[name].allowed.includes(value)) {\n          toggleCriterionOptionError(\n            option.querySelector(\".comma-sep-input--input\"),\n            `${value} isn't an accepted language. Options are ${criterion[\n              name\n            ].allowed\n              .slice(0, criterion[name].allowed.length - 1)\n              .join(\", \")} and ${\n              criterion[name].allowed[criterion[name].allowed.length - 1]\n            }.`,\n          );\n          option.querySelector(\".comma-sep-input--input\").value = \"\";\n          event.preventDefault();\n          return;\n        }\n      }\n    } else if (event.key === \"Backspace\") {\n      value = option.querySelector(\".comma-sep-input--input\").value;\n      if (value) {\n        return;\n      }\n    } else {\n      return;\n    }\n  } else if (\n    type === \"PositiveIntegerField\" ||\n    type === \"ProbabilityField\" ||\n    type === \"FloatField\" ||\n    type === \"IntegerField\"\n  ) {\n    option.setCustomValidity(\"\");\n    value = option.value;\n    if (value === \"\") {\n      if (event.inputType === \"insertText\" && event.data === \"-\") {\n        value = 0;\n        option.value = 0;\n      } else {\n        return;\n      }\n    }\n    if (type === \"ProbabilityField\") {\n      if (value < 0) {\n        value = 0;\n        option.value = value;\n      } else if (value > 1) {\n        value = parseFloat(\"0.\" + value);\n        option.value = value;\n      } else if (value.toString().length > 4) {\n        option.value = model.criterions.filter(\n          (c) => c.name === criterion.name,\n        )[0][name].value;\n        return;\n      } else if (\n        model.criterions.filter((c) => c.name === criterion.name)[0][name]\n          .value == value\n      ) {\n        if (value === \"00\") {\n          option.value = \"0\";\n        }\n        return;\n      }\n    }\n  } else if (type === \"BooleanField\") {\n    option.setCustomValidity(\"\");\n    value = option.value === \"false\";\n  } else {\n    option.setCustomValidity(\"\");\n    value = option.value;\n  }\n\n  const data = {\n    quality: model.quality.pk,\n    criterion: criterion.name,\n    field: name,\n    value: value,\n  };\n\n  const req = buildReq(data, \"post\");\n  fetch(model.urls.updateCriterion, req)\n    .then((resp) => (resp.ok ? resp.json() : resp.text()))\n    .then((data) => {\n      if (typeof data === \"string\") {\n        toggleCriterionOptionError(err);\n      } else {\n        model.criterions = model.criterions.map((c) =>\n          c.name === data.name ? data : c,\n        );\n        if (name === \"weight\") {\n          criterionOptionView(type, data.weight, criterion, option);\n        } else {\n          criterionOptionView(type, data[name].value, criterion, option);\n        }\n      }\n    })\n    .catch((err) => console.log(err));\n}\n\nfunction addCriterion(criterion) {\n  const data = {\n    quality: model.quality.pk,\n    criterion: criterion.name,\n  };\n\n  const req = buildReq(data, \"post\");\n  fetch(model.urls.addCriterion, req)\n    .then((resp) => resp.json())\n    .then((json) => {\n      model.criterions.push(json);\n      criterionsView();\n      newCriterionsView();\n      toggleShowAddCriterion();\n    })\n    .catch((err) => console.log(err));\n}\n\nfunction removeCriterion(criterion) {\n  const data = {\n    quality: model.quality.pk,\n    criterion: criterion.name,\n  };\n  const req = buildReq(data, \"post\");\n  fetch(model.urls.removeCriterion, req)\n    .then((resp) => {\n      if (resp.ok) {\n        model.criterions = model.criterions.filter(\n          (c) => c.name != criterion.name,\n        );\n        criterionsView();\n        newCriterionsView();\n      }\n    })\n    .catch((err) => console.log(err));\n}\n\n/********/\n/* view */\n/********/\n\nfunction view() {\n  returnLinkView();\n  criterionsView();\n  newCriterionsView();\n}\n\nfunction returnLinkView() {\n  const link = document.querySelector(\"#back-link\");\n  if (model.next) {\n    link.href = model.next;\n    if (model.quality.qualityType === \"teacher\") {\n      link.textContent = \"Back to account\";\n    } else {\n      link.textContent = `Back to ${model.quality.qualityType}`;\n    }\n  } else {\n    link.parentNode.removeChild(link);\n  }\n}\n\nfunction criterionsView() {\n  const div = document.querySelector(\"#criterions\");\n  clear(div);\n  model.criterions.forEach((criterion) => {\n    div.appendChild(criterionView(criterion));\n  });\n}\n\nfunction criterionView(criterion) {\n  const div = document.createElement(\"div\");\n  div.classList.add(\"criterion\");\n  div.classList.add(\"criterion__showing\");\n  div.name = criterion.name;\n\n  const name = document.createElement(\"div\");\n  name.classList.add(\"criterion--name\");\n  name.textContent = criterion.full_name;\n  name.title = criterion.description;\n  name.addEventListener(\"click\", () => toggleCriterionOptions(div));\n  div.appendChild(name);\n\n  const remove = document.createElement(\"button\");\n  remove.classList.add(\"criterion--remove\");\n  remove.addEventListener(\"click\", (event) => {\n    removeCriterion(criterion);\n    event.stopPropagation();\n  });\n  name.appendChild(remove);\n  const icon = document.createElement(\"i\");\n  icon.classList.add(\"material-icons\");\n  icon.textContent = \"close\";\n  remove.appendChild(icon);\n\n  const options = document.createElement(\"div\");\n  options.classList.add(\"criterion--options\");\n  div.appendChild(options);\n\n  const binaryThreshold =\n    criterion.versions[criterion.version - 1].binary_threshold;\n\n  // const versionLabel = document.createElement(\"label\");\n  // versionLabel.textContent = \"Version:\";\n  // const version = document.createElement(\"select\");\n  // const versions = [document.createElement(\"option\")];\n  // versions[0].value = 0;\n  // versions[0].textContent = \"0 (latest)\";\n  // versions.forEach(v => {\n  // version.appendChild(v);\n  // });\n  // options.appendChild(versionLabel);\n  // options.appendChild(version);\n  //\n  const weightLabel = document.createElement(\"label\");\n  weightLabel.textContent = \"Weight:\";\n  const weight = criterionOptionView(\n    \"PositiveIntegerField\",\n    criterion.weight,\n    criterion,\n  );\n  weight.name = \"weight\";\n  options.appendChild(weightLabel);\n  options.appendChild(weight);\n\n  const otherOptions = Object.keys(criterion).filter(\n    (o) =>\n      ![\n        \"description\",\n        \"full_name\",\n        \"is_beta\",\n        \"name\",\n        \"version\",\n        \"versions\",\n        \"weight\",\n      ].includes(o),\n  );\n  otherOptions.forEach((o) => {\n    if (!binaryThreshold || o !== \"threshold\") {\n      const option = criterion[o];\n      const label = document.createElement(\"label\");\n      label.textContent = `${option.full_name}:`;\n      label.title = option.description;\n      const input = criterionOptionView(\n        option.type,\n        option.value,\n        criterion,\n        null,\n      );\n      input.setAttribute(\"name\", option.name);\n      options.appendChild(label);\n      options.appendChild(input);\n    }\n  });\n\n  return div;\n}\n\nfunction criterionOptionView(type, value, criterion, input = null) {\n  const focus = !!input;\n  if (type === \"PositiveIntegerField\") {\n    if (!input) {\n      input = document.createElement(\"input\");\n      input.setAttribute(\"data-type\", type);\n      input.type = \"number\";\n      input.min = 0;\n      input.addEventListener(\"input\", (event) =>\n        updateCriterionOption(event, input, criterion),\n      );\n    }\n    input.value = value;\n    return input;\n  } else if (type === \"ProbabilityField\") {\n    if (!input) {\n      input = document.createElement(\"input\");\n      input.setAttribute(\"data-type\", type);\n      input.type = \"number\";\n      input.min = 0;\n      input.max = 1;\n      input.step = 0.01;\n      input.addEventListener(\"input\", (event) =>\n        updateCriterionOption(event, input, criterion),\n      );\n      if (focus) {\n        input.focus();\n      }\n    }\n    input.value = value;\n    return input;\n  } else if (type === \"CommaSepField\" || type === \"ManyToManyField\") {\n    if (!input) {\n      input = document.createElement(\"div\");\n      input.setAttribute(\"data-type\", type);\n      input.classList.add(\"comma-sep-input\");\n      input.type = \"comma-sep\";\n    }\n    clear(input);\n    value.forEach((word) => {\n      const span = document.createElement(\"span\");\n      span.classList.add(\"comma-sep-input--word\");\n      span.textContent = word;\n      input.appendChild(span);\n    });\n    const input_ = document.createElement(\"input\");\n    input_.classList.add(\"comma-sep-input--input\");\n    input_.type = \"text\";\n    input_.addEventListener(\"keydown\", (event) =>\n      updateCriterionOption(event, input, criterion),\n    );\n    input.appendChild(input_);\n    if (focus) {\n      input_.focus();\n    }\n    return input;\n  } else if (type === \"BooleanField\") {\n    if (!input) {\n      input = document.createElement(\"div\");\n      input.setAttribute(\"data-type\", type);\n      input.classList.add(\"boolean-input\");\n      clear(input);\n      const input_ = document.createElement(\"input\");\n      input_.classList.add(\"boolean-input--input\");\n      input_.type = \"checkbox\";\n      input_.addEventListener(\"click\", (event) =>\n        updateCriterionOption(event, input, criterion),\n      );\n      input.appendChild(input_);\n      const background = document.createElement(\"span\");\n      background.classList.add(\"boolean-input--background\");\n      input.appendChild(background);\n      const mark = document.createElement(\"span\");\n      mark.classList.add(\"boolean-input--mark\");\n      input.appendChild(mark);\n      if (focus) {\n        input_.focus();\n      }\n    }\n    input.value = value;\n    return input;\n  }\n}\n\nfunction toggleCriterionOptions(criterion) {\n  if (criterion.classList.contains(\"criterion__showing\")) {\n    criterion.classList.remove(\"criterion__showing\");\n  } else {\n    criterion.classList.add(\"criterion__showing\");\n  }\n}\n\nfunction toggleCriterionOptionError(option, msg) {\n  option.setCustomValidity(msg);\n}\n\nfunction newCriterionsView() {\n  const button = document.querySelector(\".add-criterion button\");\n  const available = model.available.filter(\n    (c) => !model.criterions.map((cc) => cc.name).includes(c.name),\n  );\n  if (available.length) {\n    const ul = document.querySelector(\".available-criterions ul\");\n    clear(ul);\n    available.forEach((criterion) => {\n      ul.appendChild(newCriterionView(criterion));\n    });\n    button.disabled = false;\n    button.title = \"Add a new criterion\";\n  } else {\n    button.disabled = true;\n    button.title = \"There are no new criterions to add\";\n  }\n}\n\nfunction newCriterionView(criterion) {\n  const li = document.createElement(\"li\");\n  li.title = criterion.description;\n  li.textContent = criterion.fullName;\n  li.addEventListener(\"click\", () => addCriterion(criterion));\n  return li;\n}\n\nfunction toggleShowAddCriterion() {\n  const div = document.querySelector(\".add-criterion\");\n  if (div.classList.contains(\"add-criterion__showing\")) {\n    div.classList.remove(\"add-criterion__showing\");\n  } else {\n    if (model.available.length) {\n      div.classList.add(\"add-criterion__showing\");\n    }\n  }\n}\n\n/*************/\n/* listeners */\n/*************/\n\nfunction initEventListeners() {\n  initAddCriterionListeners();\n}\n\nfunction initAddCriterionListeners() {\n  document\n    .querySelector(\".add-criterion button\")\n    .addEventListener(\"click\", toggleShowAddCriterion);\n}\n\n/********/\n/* init */\n/********/\n\nexport function init(data) {\n  initModel(data);\n  view();\n  initEventListeners();\n}\n"],"names":["getCsrfToken","document","getElementsByName","getAttribute","buildReq","data","method","toLowerCase","toUpperCase","headers","body","JSON","stringify","Error","clear","node","hasChildNodes","removeChild","lastChild","model","updateCriterionOption","event","option","criterion","type","name","value","querySelector","setCustomValidity","key","preventDefault","allowed","includes","toggleCriterionOptionError","slice","length","join","inputType","parseFloat","toString","criterions","filter","c","req","quality","pk","field","fetch","urls","updateCriterion","then","resp","ok","json","text","err","map","criterionOptionView","weight","catch","console","log","view","link","next","href","qualityType","textContent","parentNode","returnLinkView","criterionsView","newCriterionsView","div","forEach","appendChild","createElement","classList","add","full_name","title","description","addEventListener","contains","remove","toggleCriterionOptions","removeCriterion","stopPropagation","icon","options","binaryThreshold","versions","version","binary_threshold","weightLabel","Object","keys","o","label","input","setAttribute","criterionView","focus","min","max","step","word","span","input_","background","mark","msg","button","available","cc","ul","li","fullName","addCriterion","push","toggleShowAddCriterion","newCriterionView","disabled","initEventListeners","quality_type","add_criterion","update_criterion","remove_criterion","initModel"],"mappings":"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"}