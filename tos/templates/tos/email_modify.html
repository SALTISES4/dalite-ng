{% extends user.teacher|yesno:'teacher/base.html,student/base.html' %}

{% load compress static i18n %}

{% block body %}
  <div class="mui-container">
    <h1>{% trans 'Account settings' %}</h1>

    <div class="m3-question-card">
      <h3>{% trans 'Email address' %}</h3>

      <md-divider></md-divider>

      <p></p>

      <form action="{% url 'tos:email_change' role %}?next={{ next }}" class="mui-typography-body2" method="post">
        {% csrf_token %}
        {{ form.email.errors }}
        <md-outlined-text-field
          label="{{ form.email.label }}"
          name="email"
          supporting-text="{{ form.email.help_text }}"
          required
          type="email"
          value="{{ form.email.value }}">
        </md-outlined-text-field>
        <div>
          <md-filled-button type="submit">
            {% trans 'Save' %}
          </md-filled-button>
        </div>
      </form>
    </div>

    <div class="m3-question-card">
      <h3>{% trans 'Notifications' %}</h3>

      <md-divider></md-divider>

      <p class="mui-typography-body2">
        {% blocktrans %}
          Use the toggle buttons below to control which types of emails myDALITE is permitted to send you.  Certain emails will be sent regardless of the settings below (for example a password reset link).
        {% endblocktrans %}
      </p>

      <form id="email-settings-form" action="{% url 'tos:email_update' role %}?next={{next}}" method="post">
        {% csrf_token %}

        {% for email_type in email_types %}
          <div class="m3-switch-field">
            <md-switch id="{{ email_type.type }}" name="{{ email_type.type }}-consent" {% if email_type.accepted %}selected{% endif %}></md-switch>
            <div>
              <label for="{{ email_type.type }}">{{ email_type.title }}</label>
              <p>
                {{ email_type.description }}
              </p>
            </div>
          </div>
        {% endfor %}

        <div>
          <md-filled-button type="submit">
            {% trans 'Save' %}
          </md-filled-button>
        </div>
      </form>
    </div>
  </div>
{% endblock %}
