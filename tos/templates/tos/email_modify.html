{% extends user.teacher|yesno:'teacher/base.html,student/base.html' %}

{% load compress static i18n %}

{% block apps %}
  {% compress js file email_notifications %}
    <script
      src="{% static 'tos/js/email.min.js' %}"
      defer="true"
    ></script>
  {% endcompress %}
{% endblock %}

{% block body %}
  <div class="mui-container">
    <h1>{% trans 'Notification settings' %}</h1>

    <div class="m3-question-card">
      <h3>{% trans 'Email' %}</h3>

      <md-divider></md-divider>

      <p class="mui-typography-body2">
        {% blocktrans %}
          Use the toggle buttons below to control which types of emails myDALITE is permitted to send you.  Certain emails will be sent regardless of the settings below (for example a password reset link).
        {% endblocktrans %}
      </p>

      <form id="email-settings-form" action="{% url 'tos:email_update' role %}?next={{next}}" method="post">
        {% csrf_token %}
        {% for email_type in email_types %}
          <div class="m3-switch-field">
            <md-switch id="notification-{{ email_type.type }}" name="{{ email_type.type }}-consent" {% if email_type.accepted %}selected{% endif %}></md-switch>
            <div>
              <label for="notification-{{ email_type.type }}">{{ email_type.title }}</label>
              <p>
                {{ email_type.description }}
              </p>
            </div>
          </div>
        {% endfor %}
      </form>
    </div>

    <div class="m3-button-container">
      <md-filled-button form="email-settings-form" type="submit">
        {% trans 'Save' %}
      </md-filled-button>
    </div>
  </div>
{% endblock %}
