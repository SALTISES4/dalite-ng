!function(){"use strict";function t(){return document.getElementsByName("csrfmiddlewaretoken")[0].getAttribute("value")}class e extends HTMLElement{static get observedAttributes(){return["stale"]}get reputationUrl(){const t=this.getAttribute("reputation-url");if(!t)throw new Error("The reputation-header needs a `reputation-url` attribute");return t}get reputationStyleUrl(){const t=this.getAttribute("reputation-style-url");if(!t)throw new Error("The reputation-header needs a `reputation-style-url` attribute");return t}get reputationId(){const t=this.getAttribute("reputation-id");if(!t)throw new Error("The reputation-header needs a `reputation-id` attribute");return t}get nonce_(){const t=this.getAttribute("nonce")||this.nonce;if(!t)throw new Error("The teacher-reputation-header needs a `nonce` attribute");return t}get hidden(){return this.hasAttribute("hidden")}get open(){return this.hasAttribute("open")}set hidden(t){t?this.setAttribute("hidden",""):this.removeAttribute("hidden")}set open(t){t?this.setAttribute("open",""):this.removeAttribute("open")}constructor(){super();const t=this.attachShadow({mode:"open"});this.hidden=!0,this.init(t)}attributeChangedCallback(t,e,n){"stale"===t&&this.update()}}class n extends e{async init(e){const n={id:parseInt(this.reputationId),element:this,reputation:null,reputationStyleUrl:this.reputationStyleUrl,reputationType:"teacher",reputationUrl:this.reputationUrl,reputations:[],shadow:e};async function i(){await async function(){const e=function(e,n){if("get"===n.toLowerCase())return{method:n.toUpperCase(),headers:{"Content-Type":"application/json","X-CSRFToken":t()}};if("post"===n.toLowerCase()){const i=e?JSON.stringify(e):"";return{method:n.toUpperCase(),body:i,headers:{"Content-Type":"application/json","X-CSRFToken":t()}}}throw Error("Method ".concat(n," not implemented yet."))}({reputation_type:n.reputationType,id:n.id},"post"),i=await fetch(n.reputationUrl,e),o=await i.json();n.reputation=o.reputation,n.reputations=o.reputations.map(t=>({name:t.full_name,description:t.description,reputation:t.reputation})),r(),a()}(),null!==n.reputation&&(n.element.hidden=!1)}function o(){const t=n.element;document.querySelectorAll(".header--togglable > *").forEach(e=>{e!=t&&e.hasAttribute("open")&&(e.shadowRoot?e.shadowRoot.querySelector(".header__icon").dispatchEvent(new Event("click")):e.querySelector(".header__icon").dispatchEvent(new Event("click")))}),n.element.open=!n.element.open,r(),a()}function r(){let t=e.getElementById("icon");if(t)null!==n.reputation&&void 0!==n.reputation&&(e.getElementById("icon__reputation").textContent=n.reputation.toString());else{var i;t=document.createElement("div"),t.id="icon",t.classList.add("header__icon"),t.title="Reputation",t.addEventListener("click",t=>{t.stopPropagation(),o()});const e=document.createElement("i");e.id="icon__icon",e.textContent="star",t.appendChild(e);const r=document.createElement("span");r.id="icon__reputation",null!==n.reputation&&void 0!==n.reputation&&(r.textContent=n.reputation.toString()),t.appendChild(r),null===(i=document.body)||void 0===i||i.addEventListener("click",t=>{n.element.open&&o()})}return t}function a(){let t=e.getElementById("list");return t||(t=document.createElement("div"),t.id="list",t.addEventListener("click",t=>{t.stopPropagation()})),function(t){for(;t.hasChildNodes();)t.removeChild(t.lastChild)}(t),function(t){const e=document.createElement("div");e.classList.add("list__header"),e.textContent="Name",t.appendChild(e);const n=document.createElement("div");n.classList.add("list__header"),n.textContent="Reputation",t.appendChild(n)}(t),n.reputations.forEach(e=>{!function(t,e){const n=document.createElement("div");n.classList.add("list__name"),n.textContent="".concat(e.name),n.title=e.description,t.appendChild(n);const i=document.createElement("div");i.classList.add("list__reputation"),i.textContent=(Math.round(100*e.reputation)/100).toString(),t.appendChild(i)}(t,e)}),t}this.update=i,function(){e.appendChild(function(){const t=document.createElement("link");return t.setAttribute("href",n.reputationStyleUrl),t.setAttribute("rel","stylesheet"),t.setAttribute("nonce",n.element.nonce_),t}());const t=document.createElement("div");t.id="container",e.appendChild(t),t.appendChild(r()),t.appendChild(a())}(),await i()}}customElements.get("teacher-reputation-header")||customElements.define("teacher-reputation-header",n)}();
//# sourceMappingURL=teacher.min.js.map
