{"version":3,"file":"question.min.js","sources":["peerinst/static/peerinst/js/_question/base.js","peerinst/static/peerinst/js/ajax.js","peerinst/static/peerinst/js/utils.js","peerinst/static/peerinst/js/_question/start.js","peerinst/static/peerinst/js/_question/review.js","peerinst/static/peerinst/js/question.js"],"sourcesContent":["export function submitForm() {\n  document.querySelector(\"#submit-answer-form\").submit();\n}\n","export function getCsrfToken() {\n  return document\n    .getElementsByName(\"csrfmiddlewaretoken\")[0]\n    .getAttribute(\"value\");\n}\n\nexport function buildReq(data, method) {\n  if (method.toLowerCase() === \"get\") {\n    return {\n      method: method.toUpperCase(),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"X-CSRFToken\": getCsrfToken(),\n      },\n    };\n  } else if (method.toLowerCase() === \"post\") {\n    const body = data ? JSON.stringify(data) : \"\";\n    return {\n      method: method.toUpperCase(),\n      body: body,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"X-CSRFToken\": getCsrfToken(),\n      },\n    };\n  } else {\n    throw Error(`Method ${method} not implemented yet.`);\n  }\n}\n","// @flow\n\"use strict\";\n\nexport function clear(node: HTMLElement): HTMLElement {\n  while (node.hasChildNodes()) {\n    // $FlowFixMe\n    node.removeChild(node.lastChild);\n  }\n  return node;\n}\n\nexport function formatDatetime(datetime: Date): string {\n  return (\n    datetime.toLocaleString(\"en-ca\", { year: \"numeric\" }) +\n    \"-\" +\n    datetime.toLocaleString(\"en-ca\", { month: \"2-digit\" }) +\n    \"-\" +\n    datetime.toLocaleString(\"en-ca\", { day: \"2-digit\" }) +\n    \" \" +\n    datetime.toLocaleString(\"en-ca\", { hour: \"2-digit\", hour12: false }) +\n    \":\" +\n    datetime.toLocaleString(\"en-ca\", { minute: \"2-digit\" })\n  );\n}\n\nexport function createSvg(name: string): Element {\n  const svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n  const use = document.createElementNS(\"http://www.w3.org/2000/svg\", \"use\");\n  use.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\", `#${name}`);\n  svg.append(use);\n  return svg;\n}\n\nexport function showAlert(msg: string) {\n  const fullPageBox = document.createElement(\"div\");\n  fullPageBox.classList.add(\"alert-box__full-page\");\n  fullPageBox.addEventListener(\"click\", (event: MouseEvent) => {\n    event.stopPropagation();\n    fullPageBox.parentNode?.removeChild(fullPageBox);\n  });\n  document.body?.appendChild(fullPageBox);\n\n  const box = document.createElement(\"div\");\n  box.classList.add(\"alert-box__box\");\n  box.addEventListener(\"click\", (event: MouseEvent) =>\n    event.stopPropagation(),\n  );\n  fullPageBox.appendChild(box);\n\n  const span = document.createElement(\"span\");\n  span.classList.add(\"alert-box__msg\");\n  span.textContent = msg;\n  box.appendChild(span);\n\n  const ok = document.createElement(\"button\");\n  ok.classList.add(\"alert-box__btn\", \"mdc-button\", \"mdc-button--unelevated\");\n  ok.textContent = \"Ok\";\n  box.appendChild(ok);\n}\n","import { buildReq } from \"../ajax.js\";\nimport { clear } from \"../utils.js\";\n\n/**********/\n/* update */\n/**********/\n\nexport function validateFormSubmit(event, url, quality) {\n  event.preventDefault();\n  const data = {\n    quality: quality,\n    rationale: document.querySelector(\"#id_rationale\").value,\n  };\n\n  const req = buildReq(data, \"post\");\n  fetch(url, req)\n    .then(resp => resp.json())\n    .then(failed => {\n      if (failed.failed.length) {\n        toggleQualityError(failed.failed, failed.error_msg);\n        document.querySelector(\"#answer-form\").disabled = false;\n      } else {\n        toggleQualityError();\n        document.querySelector(\"#answer-form\").disabled = true;\n        document.querySelector(\"#submit-answer-form\").submit();\n      }\n    })\n    .catch(err => console.log(err));\n}\n\n/********/\n/* view */\n/********/\n\nfunction toggleQualityError(data, errorMsg) {\n  if (data) {\n    const form = document.querySelector(\"#submit-answer-form\");\n\n    let div = document.querySelector(\".errorlist\");\n    if (!div) {\n      div = document.createElement(\"div\");\n    }\n    clear(div);\n\n    div.classList.add(\"errorlist\");\n    div.textContent = errorMsg;\n\n    const ul = document.createElement(\"ul\");\n    div.append(ul);\n    data.forEach(criterion => {\n      const li = document.createElement(\"li\");\n      li.textContent = criterion.name;\n      li.title = criterion.description;\n      ul.append(li);\n    });\n\n    form.parentNode.insertBefore(div, form);\n  } else {\n    const err = document.querySelector(\"errorlist\");\n    if (err) {\n      err.parentNode.removeChild(err);\n    }\n  }\n}\n","// @flow\n\n/*********/\n/* model */\n/*********/\n\nlet model: {\n  submitAllowed: boolean,\n};\n\nfunction initModel() {\n  model = {\n    submitAllowed: false,\n  };\n}\n\n/**********/\n/* update */\n/**********/\n\nfunction startSubmitAllowedTimer(seconds: number) {\n  setInterval(allowSubmit, seconds * 1000);\n}\n\nfunction allowSubmit() {\n  model.submitAllowed = true;\n  submitButtonView();\n}\n\n/********/\n/* view */\n/********/\n\nfunction view() {\n  submitButtonView();\n}\n\nfunction submitButtonView() {\n  if (model.submitAllowed) {\n    // $FlowFixMe\n    document.getElementById(\"answer-form\").disabled = false;\n  } else {\n    // $FlowFixMe\n    document.getElementById(\"answer-form\").disabled = true;\n  }\n}\n\n/********/\n/* init */\n/********/\n\nexport function init() {\n  initModel();\n  view();\n  startSubmitAllowedTimer(5);\n}\n","\"use strict\";\n\nexport { submitForm } from \"./_question/base.js\";\n\nexport { validateFormSubmit } from \"./_question/start.js\";\n\nexport { init as initReview } from \"./_question/review.js\";\n"],"names":["submitForm","document","querySelector","submit","getCsrfToken","getElementsByName","getAttribute","buildReq","data","method","toLowerCase","toUpperCase","headers","body","JSON","stringify","Error","clear","node","hasChildNodes","removeChild","lastChild","validateFormSubmit","event","url","quality","preventDefault","rationale","value","req","fetch","then","resp","json","failed","length","toggleQualityError","error_msg","disabled","catch","err","console","log","errorMsg","form","div","createElement","classList","add","textContent","ul","append","forEach","criterion","li","name","title","description","parentNode","insertBefore","model","initModel","submitAllowed","startSubmitAllowedTimer","seconds","setInterval","allowSubmit","submitButtonView","view","getElementById","init"],"mappings":"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","preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjpudWxsLCJzb3VyY2VzIjpbIi9ob21lL2FudG9pbmUvZG9jdW1lbnRzL3dvcmsvc2NpdmVyby9wcm9qZWN0cy9kYWxpdGUvZGFsaXRlL3BlZXJpbnN0L3N0YXRpYy9wZWVyaW5zdC9qcy9fcXVlc3Rpb24vYmFzZS5qcyIsIi9ob21lL2FudG9pbmUvZG9jdW1lbnRzL3dvcmsvc2NpdmVyby9wcm9qZWN0cy9kYWxpdGUvZGFsaXRlL3BlZXJpbnN0L3N0YXRpYy9wZWVyaW5zdC9qcy9hamF4LmpzIiwiL2hvbWUvYW50b2luZS9kb2N1bWVudHMvd29yay9zY2l2ZXJvL3Byb2plY3RzL2RhbGl0ZS9kYWxpdGUvcGVlcmluc3Qvc3RhdGljL3BlZXJpbnN0L2pzL3V0aWxzLmpzIiwiL2hvbWUvYW50b2luZS9kb2N1bWVudHMvd29yay9zY2l2ZXJvL3Byb2plY3RzL2RhbGl0ZS9kYWxpdGUvcGVlcmluc3Qvc3RhdGljL3BlZXJpbnN0L2pzL19xdWVzdGlvbi9zdGFydC5qcyIsIi9ob21lL2FudG9pbmUvZG9jdW1lbnRzL3dvcmsvc2NpdmVyby9wcm9qZWN0cy9kYWxpdGUvZGFsaXRlL3BlZXJpbnN0L3N0YXRpYy9wZWVyaW5zdC9qcy9fcXVlc3Rpb24vcmV2aWV3LmpzIiwiL2hvbWUvYW50b2luZS9kb2N1bWVudHMvd29yay9zY2l2ZXJvL3Byb2plY3RzL2RhbGl0ZS9kYWxpdGUvcGVlcmluc3Qvc3RhdGljL3BlZXJpbnN0L2pzL3F1ZXN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBzdWJtaXRGb3JtKCkge1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3N1Ym1pdC1hbnN3ZXItZm9ybVwiKS5zdWJtaXQoKTtcbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBnZXRDc3JmVG9rZW4oKSB7XG4gIHJldHVybiBkb2N1bWVudFxuICAgIC5nZXRFbGVtZW50c0J5TmFtZShcImNzcmZtaWRkbGV3YXJldG9rZW5cIilbMF1cbiAgICAuZ2V0QXR0cmlidXRlKFwidmFsdWVcIik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBidWlsZFJlcShkYXRhLCBtZXRob2QpIHtcbiAgaWYgKG1ldGhvZC50b0xvd2VyQ2FzZSgpID09PSBcImdldFwiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG1ldGhvZDogbWV0aG9kLnRvVXBwZXJDYXNlKCksXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICBcIlgtQ1NSRlRva2VuXCI6IGdldENzcmZUb2tlbigpLFxuICAgICAgfSxcbiAgICB9O1xuICB9IGVsc2UgaWYgKG1ldGhvZC50b0xvd2VyQ2FzZSgpID09PSBcInBvc3RcIikge1xuICAgIGNvbnN0IGJvZHkgPSBkYXRhID8gSlNPTi5zdHJpbmdpZnkoZGF0YSkgOiBcIlwiO1xuICAgIHJldHVybiB7XG4gICAgICBtZXRob2Q6IG1ldGhvZC50b1VwcGVyQ2FzZSgpLFxuICAgICAgYm9keTogYm9keSxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgIFwiWC1DU1JGVG9rZW5cIjogZ2V0Q3NyZlRva2VuKCksXG4gICAgICB9LFxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgRXJyb3IoYE1ldGhvZCAke21ldGhvZH0gbm90IGltcGxlbWVudGVkIHlldC5gKTtcbiAgfVxufVxuIiwiLy8gQGZsb3dcblwidXNlIHN0cmljdFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXIobm9kZTogSFRNTEVsZW1lbnQpOiBIVE1MRWxlbWVudCB7XG4gIHdoaWxlIChub2RlLmhhc0NoaWxkTm9kZXMoKSkge1xuICAgIC8vICRGbG93Rml4TWVcbiAgICBub2RlLnJlbW92ZUNoaWxkKG5vZGUubGFzdENoaWxkKTtcbiAgfVxuICByZXR1cm4gbm9kZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdERhdGV0aW1lKGRhdGV0aW1lOiBEYXRlKTogc3RyaW5nIHtcbiAgcmV0dXJuIChcbiAgICBkYXRldGltZS50b0xvY2FsZVN0cmluZyhcImVuLWNhXCIsIHsgeWVhcjogXCJudW1lcmljXCIgfSkgK1xuICAgIFwiLVwiICtcbiAgICBkYXRldGltZS50b0xvY2FsZVN0cmluZyhcImVuLWNhXCIsIHsgbW9udGg6IFwiMi1kaWdpdFwiIH0pICtcbiAgICBcIi1cIiArXG4gICAgZGF0ZXRpbWUudG9Mb2NhbGVTdHJpbmcoXCJlbi1jYVwiLCB7IGRheTogXCIyLWRpZ2l0XCIgfSkgK1xuICAgIFwiIFwiICtcbiAgICBkYXRldGltZS50b0xvY2FsZVN0cmluZyhcImVuLWNhXCIsIHsgaG91cjogXCIyLWRpZ2l0XCIsIGhvdXIxMjogZmFsc2UgfSkgK1xuICAgIFwiOlwiICtcbiAgICBkYXRldGltZS50b0xvY2FsZVN0cmluZyhcImVuLWNhXCIsIHsgbWludXRlOiBcIjItZGlnaXRcIiB9KVxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU3ZnKG5hbWU6IHN0cmluZyk6IEVsZW1lbnQge1xuICBjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLCBcInN2Z1wiKTtcbiAgY29uc3QgdXNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgXCJ1c2VcIik7XG4gIHVzZS5zZXRBdHRyaWJ1dGVOUyhcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIiwgXCJocmVmXCIsIGAjJHtuYW1lfWApO1xuICBzdmcuYXBwZW5kKHVzZSk7XG4gIHJldHVybiBzdmc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaG93QWxlcnQobXNnOiBzdHJpbmcpIHtcbiAgY29uc3QgZnVsbFBhZ2VCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBmdWxsUGFnZUJveC5jbGFzc0xpc3QuYWRkKFwiYWxlcnQtYm94X19mdWxsLXBhZ2VcIik7XG4gIGZ1bGxQYWdlQm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBmdWxsUGFnZUJveC5wYXJlbnROb2RlPy5yZW1vdmVDaGlsZChmdWxsUGFnZUJveCk7XG4gIH0pO1xuICBkb2N1bWVudC5ib2R5Py5hcHBlbmRDaGlsZChmdWxsUGFnZUJveCk7XG5cbiAgY29uc3QgYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgYm94LmNsYXNzTGlzdC5hZGQoXCJhbGVydC1ib3hfX2JveFwiKTtcbiAgYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCksXG4gICk7XG4gIGZ1bGxQYWdlQm94LmFwcGVuZENoaWxkKGJveCk7XG5cbiAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICBzcGFuLmNsYXNzTGlzdC5hZGQoXCJhbGVydC1ib3hfX21zZ1wiKTtcbiAgc3Bhbi50ZXh0Q29udGVudCA9IG1zZztcbiAgYm94LmFwcGVuZENoaWxkKHNwYW4pO1xuXG4gIGNvbnN0IG9rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgb2suY2xhc3NMaXN0LmFkZChcImFsZXJ0LWJveF9fYnRuXCIsIFwibWRjLWJ1dHRvblwiLCBcIm1kYy1idXR0b24tLXVuZWxldmF0ZWRcIik7XG4gIG9rLnRleHRDb250ZW50ID0gXCJPa1wiO1xuICBib3guYXBwZW5kQ2hpbGQob2spO1xufVxuIiwiaW1wb3J0IHsgYnVpbGRSZXEgfSBmcm9tIFwiLi4vYWpheC5qc1wiO1xuaW1wb3J0IHsgY2xlYXIgfSBmcm9tIFwiLi4vdXRpbHMuanNcIjtcblxuLyoqKioqKioqKiovXG4vKiB1cGRhdGUgKi9cbi8qKioqKioqKioqL1xuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVGb3JtU3VibWl0KGV2ZW50LCB1cmwsIHF1YWxpdHkpIHtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgZGF0YSA9IHtcbiAgICBxdWFsaXR5OiBxdWFsaXR5LFxuICAgIHJhdGlvbmFsZTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpZF9yYXRpb25hbGVcIikudmFsdWUsXG4gIH07XG5cbiAgY29uc3QgcmVxID0gYnVpbGRSZXEoZGF0YSwgXCJwb3N0XCIpO1xuICBmZXRjaCh1cmwsIHJlcSlcbiAgICAudGhlbihyZXNwID0+IHJlc3AuanNvbigpKVxuICAgIC50aGVuKGZhaWxlZCA9PiB7XG4gICAgICBpZiAoZmFpbGVkLmZhaWxlZC5sZW5ndGgpIHtcbiAgICAgICAgdG9nZ2xlUXVhbGl0eUVycm9yKGZhaWxlZC5mYWlsZWQsIGZhaWxlZC5lcnJvcl9tc2cpO1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Fuc3dlci1mb3JtXCIpLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0b2dnbGVRdWFsaXR5RXJyb3IoKTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhbnN3ZXItZm9ybVwiKS5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc3VibWl0LWFuc3dlci1mb3JtXCIpLnN1Ym1pdCgpO1xuICAgICAgfVxuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcbn1cblxuLyoqKioqKioqL1xuLyogdmlldyAqL1xuLyoqKioqKioqL1xuXG5mdW5jdGlvbiB0b2dnbGVRdWFsaXR5RXJyb3IoZGF0YSwgZXJyb3JNc2cpIHtcbiAgaWYgKGRhdGEpIHtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNzdWJtaXQtYW5zd2VyLWZvcm1cIik7XG5cbiAgICBsZXQgZGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lcnJvcmxpc3RcIik7XG4gICAgaWYgKCFkaXYpIHtcbiAgICAgIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgfVxuICAgIGNsZWFyKGRpdik7XG5cbiAgICBkaXYuY2xhc3NMaXN0LmFkZChcImVycm9ybGlzdFwiKTtcbiAgICBkaXYudGV4dENvbnRlbnQgPSBlcnJvck1zZztcblxuICAgIGNvbnN0IHVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInVsXCIpO1xuICAgIGRpdi5hcHBlbmQodWwpO1xuICAgIGRhdGEuZm9yRWFjaChjcml0ZXJpb24gPT4ge1xuICAgICAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XG4gICAgICBsaS50ZXh0Q29udGVudCA9IGNyaXRlcmlvbi5uYW1lO1xuICAgICAgbGkudGl0bGUgPSBjcml0ZXJpb24uZGVzY3JpcHRpb247XG4gICAgICB1bC5hcHBlbmQobGkpO1xuICAgIH0pO1xuXG4gICAgZm9ybS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkaXYsIGZvcm0pO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGVyciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJlcnJvcmxpc3RcIik7XG4gICAgaWYgKGVycikge1xuICAgICAgZXJyLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZXJyKTtcbiAgICB9XG4gIH1cbn1cbiIsIi8vIEBmbG93XG5cbi8qKioqKioqKiovXG4vKiBtb2RlbCAqL1xuLyoqKioqKioqKi9cblxubGV0IG1vZGVsOiB7XG4gIHN1Ym1pdEFsbG93ZWQ6IGJvb2xlYW4sXG59O1xuXG5mdW5jdGlvbiBpbml0TW9kZWwoKSB7XG4gIG1vZGVsID0ge1xuICAgIHN1Ym1pdEFsbG93ZWQ6IGZhbHNlLFxuICB9O1xufVxuXG4vKioqKioqKioqKi9cbi8qIHVwZGF0ZSAqL1xuLyoqKioqKioqKiovXG5cbmZ1bmN0aW9uIHN0YXJ0U3VibWl0QWxsb3dlZFRpbWVyKHNlY29uZHM6IG51bWJlcikge1xuICBzZXRJbnRlcnZhbChhbGxvd1N1Ym1pdCwgc2Vjb25kcyAqIDEwMDApO1xufVxuXG5mdW5jdGlvbiBhbGxvd1N1Ym1pdCgpIHtcbiAgbW9kZWwuc3VibWl0QWxsb3dlZCA9IHRydWU7XG4gIHN1Ym1pdEJ1dHRvblZpZXcoKTtcbn1cblxuLyoqKioqKioqL1xuLyogdmlldyAqL1xuLyoqKioqKioqL1xuXG5mdW5jdGlvbiB2aWV3KCkge1xuICBzdWJtaXRCdXR0b25WaWV3KCk7XG59XG5cbmZ1bmN0aW9uIHN1Ym1pdEJ1dHRvblZpZXcoKSB7XG4gIGlmIChtb2RlbC5zdWJtaXRBbGxvd2VkKSB7XG4gICAgLy8gJEZsb3dGaXhNZVxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYW5zd2VyLWZvcm1cIikuZGlzYWJsZWQgPSBmYWxzZTtcbiAgfSBlbHNlIHtcbiAgICAvLyAkRmxvd0ZpeE1lXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbnN3ZXItZm9ybVwiKS5kaXNhYmxlZCA9IHRydWU7XG4gIH1cbn1cblxuLyoqKioqKioqL1xuLyogaW5pdCAqL1xuLyoqKioqKioqL1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdCgpIHtcbiAgaW5pdE1vZGVsKCk7XG4gIHZpZXcoKTtcbiAgc3RhcnRTdWJtaXRBbGxvd2VkVGltZXIoNSk7XG59XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0IHsgc3VibWl0Rm9ybSB9IGZyb20gXCIuL19xdWVzdGlvbi9iYXNlLmpzXCI7XG5cbmV4cG9ydCB7IHZhbGlkYXRlRm9ybVN1Ym1pdCB9IGZyb20gXCIuL19xdWVzdGlvbi9zdGFydC5qc1wiO1xuXG5leHBvcnQgeyBpbml0IGFzIGluaXRSZXZpZXcgfSBmcm9tIFwiLi9fcXVlc3Rpb24vcmV2aWV3LmpzXCI7XG4iXSwibmFtZXMiOlsic3VibWl0Rm9ybSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInN1Ym1pdCIsImdldENzcmZUb2tlbiIsImdldEVsZW1lbnRzQnlOYW1lIiwiZ2V0QXR0cmlidXRlIiwiYnVpbGRSZXEiLCJkYXRhIiwibWV0aG9kIiwidG9Mb3dlckNhc2UiLCJ0b1VwcGVyQ2FzZSIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIkVycm9yIiwiY2xlYXIiLCJub2RlIiwiaGFzQ2hpbGROb2RlcyIsInJlbW92ZUNoaWxkIiwibGFzdENoaWxkIiwidmFsaWRhdGVGb3JtU3VibWl0IiwiZXZlbnQiLCJ1cmwiLCJxdWFsaXR5IiwicHJldmVudERlZmF1bHQiLCJyYXRpb25hbGUiLCJ2YWx1ZSIsInJlcSIsImZldGNoIiwidGhlbiIsInJlc3AiLCJqc29uIiwiZmFpbGVkIiwibGVuZ3RoIiwidG9nZ2xlUXVhbGl0eUVycm9yIiwiZXJyb3JfbXNnIiwiZGlzYWJsZWQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJlcnJvck1zZyIsImZvcm0iLCJkaXYiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ1bCIsImFwcGVuZCIsImZvckVhY2giLCJjcml0ZXJpb24iLCJsaSIsIm5hbWUiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSIsIm1vZGVsIiwiaW5pdE1vZGVsIiwic3VibWl0QWxsb3dlZCIsInN0YXJ0U3VibWl0QWxsb3dlZFRpbWVyIiwic2Vjb25kcyIsInNldEludGVydmFsIiwiYWxsb3dTdWJtaXQiLCJzdWJtaXRCdXR0b25WaWV3IiwidmlldyIsImdldEVsZW1lbnRCeUlkIiwiaW5pdCJdLCJtYXBwaW5ncyI6Ijs7O0FBQU8sU0FBU0EsVUFBVCxHQUFzQjtFQUMzQkMsUUFBUSxDQUFDQyxhQUFULENBQXVCLHFCQUF2QixFQUE4Q0MsTUFBOUM7OztBQ0RLLFNBQVNDLFlBQVQsR0FBd0I7U0FDdEJILFFBQVEsQ0FDWkksaUJBREksQ0FDYyxxQkFEZCxFQUNxQyxDQURyQyxFQUVKQyxZQUZJLENBRVMsT0FGVCxDQUFQOztBQUtGLEFBQU8sU0FBU0MsUUFBVCxDQUFrQkMsSUFBbEIsRUFBd0JDLE1BQXhCLEVBQWdDO01BQ2pDQSxNQUFNLENBQUNDLFdBQVAsT0FBeUIsS0FBN0IsRUFBb0M7V0FDM0I7TUFDTEQsTUFBTSxFQUFFQSxNQUFNLENBQUNFLFdBQVAsRUFESDtNQUVMQyxPQUFPLEVBQUU7d0JBQ1Msa0JBRFQ7dUJBRVFSLFlBQVk7O0tBSi9CO0dBREYsTUFRTyxJQUFJSyxNQUFNLENBQUNDLFdBQVAsT0FBeUIsTUFBN0IsRUFBcUM7UUFDcENHLElBQUksR0FBR0wsSUFBSSxHQUFHTSxJQUFJLENBQUNDLFNBQUwsQ0FBZVAsSUFBZixDQUFILEdBQTBCLEVBQTNDO1dBQ087TUFDTEMsTUFBTSxFQUFFQSxNQUFNLENBQUNFLFdBQVAsRUFESDtNQUVMRSxJQUFJLEVBQUVBLElBRkQ7TUFHTEQsT0FBTyxFQUFFO3dCQUNTLGtCQURUO3VCQUVRUixZQUFZOztLQUwvQjtHQUZLLE1BVUE7VUFDQ1ksS0FBSyxrQkFBV1AsTUFBWCwyQkFBWDs7OztBQ3pCSjs7QUFFQSxBQUFPLFNBQVNRLEtBQVQsQ0FBZUMsSUFBZixFQUErQztTQUM3Q0EsSUFBSSxDQUFDQyxhQUFMLEVBQVAsRUFBNkI7O0lBRTNCRCxJQUFJLENBQUNFLFdBQUwsQ0FBaUJGLElBQUksQ0FBQ0csU0FBdEI7OztTQUVLSCxJQUFQOzs7QUNMRjs7Ozs7O0FBSUEsQUFBTyxTQUFTSSxrQkFBVCxDQUE0QkMsS0FBNUIsRUFBbUNDLEdBQW5DLEVBQXdDQyxPQUF4QyxFQUFpRDtFQUN0REYsS0FBSyxDQUFDRyxjQUFOO01BQ01sQixJQUFJLEdBQUc7SUFDWGlCLE9BQU8sRUFBRUEsT0FERTtJQUVYRSxTQUFTLEVBQUUxQixRQUFRLENBQUNDLGFBQVQsQ0FBdUIsZUFBdkIsRUFBd0MwQjtHQUZyRDtNQUtNQyxHQUFHLEdBQUd0QixRQUFRLENBQUNDLElBQUQsRUFBTyxNQUFQLENBQXBCO0VBQ0FzQixLQUFLLENBQUNOLEdBQUQsRUFBTUssR0FBTixDQUFMLENBQ0dFLElBREgsQ0FDUSxVQUFBQyxJQUFJO1dBQUlBLElBQUksQ0FBQ0MsSUFBTCxFQUFKO0dBRFosRUFFR0YsSUFGSCxDQUVRLFVBQUFHLE1BQU0sRUFBSTtRQUNWQSxNQUFNLENBQUNBLE1BQVAsQ0FBY0MsTUFBbEIsRUFBMEI7TUFDeEJDLGtCQUFrQixDQUFDRixNQUFNLENBQUNBLE1BQVIsRUFBZ0JBLE1BQU0sQ0FBQ0csU0FBdkIsQ0FBbEI7TUFDQXBDLFFBQVEsQ0FBQ0MsYUFBVCxDQUF1QixjQUF2QixFQUF1Q29DLFFBQXZDLEdBQWtELEtBQWxEO0tBRkYsTUFHTztNQUNMRixrQkFBa0I7TUFDbEJuQyxRQUFRLENBQUNDLGFBQVQsQ0FBdUIsY0FBdkIsRUFBdUNvQyxRQUF2QyxHQUFrRCxJQUFsRDtNQUNBckMsUUFBUSxDQUFDQyxhQUFULENBQXVCLHFCQUF2QixFQUE4Q0MsTUFBOUM7O0dBVE4sRUFZR29DLEtBWkgsQ0FZUyxVQUFBQyxHQUFHO1dBQUlDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRixHQUFaLENBQUo7R0FaWjs7Ozs7Ozs7QUFtQkYsU0FBU0osa0JBQVQsQ0FBNEI1QixJQUE1QixFQUFrQ21DLFFBQWxDLEVBQTRDO01BQ3RDbkMsSUFBSixFQUFVO1FBQ0ZvQyxJQUFJLEdBQUczQyxRQUFRLENBQUNDLGFBQVQsQ0FBdUIscUJBQXZCLENBQWI7UUFFSTJDLEdBQUcsR0FBRzVDLFFBQVEsQ0FBQ0MsYUFBVCxDQUF1QixZQUF2QixDQUFWOztRQUNJLENBQUMyQyxHQUFMLEVBQVU7TUFDUkEsR0FBRyxHQUFHNUMsUUFBUSxDQUFDNkMsYUFBVCxDQUF1QixLQUF2QixDQUFOOzs7SUFFRjdCLEtBQUssQ0FBQzRCLEdBQUQsQ0FBTDtJQUVBQSxHQUFHLENBQUNFLFNBQUosQ0FBY0MsR0FBZCxDQUFrQixXQUFsQjtJQUNBSCxHQUFHLENBQUNJLFdBQUosR0FBa0JOLFFBQWxCO1FBRU1PLEVBQUUsR0FBR2pELFFBQVEsQ0FBQzZDLGFBQVQsQ0FBdUIsSUFBdkIsQ0FBWDtJQUNBRCxHQUFHLENBQUNNLE1BQUosQ0FBV0QsRUFBWDtJQUNBMUMsSUFBSSxDQUFDNEMsT0FBTCxDQUFhLFVBQUFDLFNBQVMsRUFBSTtVQUNsQkMsRUFBRSxHQUFHckQsUUFBUSxDQUFDNkMsYUFBVCxDQUF1QixJQUF2QixDQUFYO01BQ0FRLEVBQUUsQ0FBQ0wsV0FBSCxHQUFpQkksU0FBUyxDQUFDRSxJQUEzQjtNQUNBRCxFQUFFLENBQUNFLEtBQUgsR0FBV0gsU0FBUyxDQUFDSSxXQUFyQjtNQUNBUCxFQUFFLENBQUNDLE1BQUgsQ0FBVUcsRUFBVjtLQUpGO0lBT0FWLElBQUksQ0FBQ2MsVUFBTCxDQUFnQkMsWUFBaEIsQ0FBNkJkLEdBQTdCLEVBQWtDRCxJQUFsQztHQXJCRixNQXNCTztRQUNDSixHQUFHLEdBQUd2QyxRQUFRLENBQUNDLGFBQVQsQ0FBdUIsV0FBdkIsQ0FBWjs7UUFDSXNDLEdBQUosRUFBUztNQUNQQSxHQUFHLENBQUNrQixVQUFKLENBQWV0QyxXQUFmLENBQTJCb0IsR0FBM0I7Ozs7O0FDMUROOzs7OztBQUlBLElBQUlvQixLQUFKOztBQUlBLFNBQVNDLFNBQVQsR0FBcUI7RUFDbkJELEtBQUssR0FBRztJQUNORSxhQUFhLEVBQUU7R0FEakI7Ozs7Ozs7OztBQVNGLFNBQVNDLHVCQUFULENBQWlDQyxPQUFqQyxFQUFrRDtFQUNoREMsV0FBVyxDQUFDQyxXQUFELEVBQWNGLE9BQU8sR0FBRyxJQUF4QixDQUFYOzs7QUFHRixTQUFTRSxXQUFULEdBQXVCO0VBQ3JCTixLQUFLLENBQUNFLGFBQU4sR0FBc0IsSUFBdEI7RUFDQUssZ0JBQWdCOzs7Ozs7Ozs7QUFPbEIsU0FBU0MsSUFBVCxHQUFnQjtFQUNkRCxnQkFBZ0I7OztBQUdsQixTQUFTQSxnQkFBVCxHQUE0QjtNQUN0QlAsS0FBSyxDQUFDRSxhQUFWLEVBQXlCOztJQUV2QjdELFFBQVEsQ0FBQ29FLGNBQVQsQ0FBd0IsYUFBeEIsRUFBdUMvQixRQUF2QyxHQUFrRCxLQUFsRDtHQUZGLE1BR087O0lBRUxyQyxRQUFRLENBQUNvRSxjQUFULENBQXdCLGFBQXhCLEVBQXVDL0IsUUFBdkMsR0FBa0QsSUFBbEQ7Ozs7Ozs7Ozs7QUFRSixBQUFPLFNBQVNnQyxJQUFULEdBQWdCO0VBQ3JCVCxTQUFTO0VBQ1RPLElBQUk7RUFDSkwsdUJBQXVCLENBQUMsQ0FBRCxDQUF2Qjs7O0FDdERGOzs7Ozs7Ozs7Ozs7In0="}