!function(e){"use strict";function t(){return document.getElementsByName("csrfmiddlewaretoken")[0].getAttribute("value")}function i(e,i){if("get"===i.toLowerCase())return{method:i.toUpperCase(),headers:{"Content-Type":"application/json","X-CSRFToken":t()}};if("post"===i.toLowerCase()){const n=e?JSON.stringify(e):"";return{method:i.toUpperCase(),body:n,headers:{"Content-Type":"application/json","X-CSRFToken":t()}}}throw Error("Method ".concat(i," not implemented yet."))}let n,a,o;async function r(e,t,a){if(n.canClick){n.canClick=!1;const o=i({username:t,approve:a},"post");(await fetch(n.urls.verify,o)).ok&&(e.remove(),setTimeout(()=>{n.canClick=!0},500),document.querySelectorAll("#new-user-approval li").length||window.location.reload())}}async function c(e){const t=i({},"get"),n=await fetch(a.urls.getRationales,t);a.state.rationales=(await n.json()).rationales,function(e){const t=$("#flagged-rationales__table").DataTable();t.rows().remove(),t.rows.add(a.state.rationales.map(e=>[e.rationale,e.annotator,new Date(e.timestamp).toLocaleDateString({month:"short",day:"numeric",year:"numeric"}),e.note,e.answer_pk])).draw(),$("#flagged-rationales__table").on("click","tr",(function(){window.location.href=e+"?q="+this.lastChild.innerHTML}))}(e)}function l(){document.querySelectorAll("table.display").forEach(e=>{$(e).DataTable({pageLength:10,dom:'<"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix ui-corner-tl ui-corner-tr"Bf>t<"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix ui-corner-bl ui-corner-br"ip>',buttons:[]}).order(2,"desc")})}function s(){return[...document.querySelectorAll("#discipline-activity__disciplines option")].map(e=>e.getAttribute("value"))}function u(e){o.state.discipline=e,window.localStorage.setItem("group_activity_discipline",e),async function(){const e=i({},"get"),t=o.urls.getGroupsActivity+"?discipline=".concat(o.state.discipline),n=await fetch(t,e);o.state.activity=(await n.json()).activity,function(){const e=$("#discipline-activity__groups").DataTable();e.rows().remove(),e.rows.add(o.state.activity.map(e=>[e.name,e.teacher,e.n_students])).draw()}()}()}function d(){!function(){const e=document.querySelector("#discipline-activity__disciplines");e.value=o.state.discipline,e.removeAttribute("hidden")}(),document.querySelectorAll("table.display").forEach(e=>{$(e).DataTable({pageLength:10,dom:'<"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix ui-corner-tl ui-corner-tr"Bf>t<"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix ui-corner-bl ui-corner-br"ip>',buttons:[]}).order(2,"desc")}),document.querySelector("#discipline-activity__disciplines").addEventListener("change",e=>u(e.currentTarget.value))}e.initActivity=async function(e){!function(e){const t=s();o={urls:{getGroupsActivity:e.urls.getGroupsActivity},data:{disciplines:s()},state:{discipline:window.localStorage.getItem("group_activity_discipline")||t[0],activity:[]}},u(o.state.discipline)}(e),d()},e.initFlaggedRationales=async function(e,t){!function(e){a={state:{rationales:[]},urls:{getRationales:e.urls.getRationales}}}(e),l(),c(t)},e.initNewUserApproval=function(e){!function(e){n={canClick:!0,urls:{verify:e.urls.verify}}}(e),document.querySelectorAll("#new-user-approval li").forEach(e=>{const t=e.querySelector(".user__username").textContent;e.querySelector(".user__approve").addEventListener("click",()=>r(e,t,!0)),e.querySelector(".user__refuse").addEventListener("click",()=>r(e,t,!1))})}}(this.admin=this.admin||{});
//# sourceMappingURL=admin.min.js.map
