var collection = (function (exports) {
'use strict';

function getCsrfToken() {
  var name = "csrftoken";

  if (document.cookie && document.cookie !== "") {
    return document.cookie.split(";").map(function (c) {
      return c.trim();
    }).filter(function (c) {
      return c.substring(0, name.length + 1) === name + "=";
    }).map(function (c) {
      return decodeURIComponent(c.substring(name.length + 1));
    })[0];
  } else {
    return null;
  }
}
function buildReq(data, method) {
  if (method.toLowerCase() === "get") {
    return {
      method: method.toUpperCase(),
      headers: {
        "Content-Type": "application/json",
        "X-CSRFToken": getCsrfToken()
      }
    };
  } else if (method.toLowerCase() === "post") {
    var body = data ? JSON.stringify(data) : "";
    return {
      method: method.toUpperCase(),
      body: body,
      headers: {
        "Content-Type": "application/json",
        "X-CSRFToken": getCsrfToken()
      }
    };
  } else {
    throw Error("Method ".concat(method, " not implemented yet."));
  }
}

var model;

function initModel(followerUrl) {
  model = {
    urls: {
      followerUrl: followerUrl
    }
  };
}

function init(followerUrl) {
  addEventListener();
  initModel(followerUrl);
}

function addEventListener() {
  document.querySelectorAll(".follower-button").forEach(function (element) {
    return element.addEventListener("click", toggleFollower);
  });
}

function toggleFollower(event) {
  var button = event.currentTarget;
  var pk = button.getAttribute("data-collection-pk");
  var req = buildReq({
    pk: pk
  }, "post");
  fetch(model.urls.followerUrl, req).then(function (resp) {
    if (resp.ok) {
      toggleFollowerView(button);
    } else {
      console.log(resp);
    }
  });
}

function toggleFollowerView(button) {
  if (button.classList.contains("follower-button--following")) {
    button.classList.remove("follower-button--following");
  } else {
    button.classList.add("follower-button--following");
  }
}

exports.init = init;

return exports;

}({}));
//# sourceMappingURL=collection.min.js.map
