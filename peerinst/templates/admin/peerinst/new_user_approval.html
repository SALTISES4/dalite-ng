{% extends "admin/base_site.html" %}
{% load i18n static grp_tags %}

{% block title %}{% trans 'New user approval' %}{% endblock %}

{% block extrastyle %}
<link href="{% static 'peerinst/css/admin.min.css' %}" rel="stylesheet" type="text/css" />
{% endblock %}

{% block extrahead %}
{{ block.super }}
<script src="{% static 'peerinst/js/admin.min.js' %}"></script>
<script nonce="{{ request.csp_nonce }}">
  window.addEventListener("load", () => {
    admin.initNewUserApproval({
      urls: {
        verify: "{% url 'admin--verify-user' %}"
      }
    });
  });
</script>
{% endblock %}

{% block breadcrumbs %}
<ul>
  <li><a href="{% url 'admin-index' %}">{% trans 'Home' %}</a></li>
  <li>{% trans 'New user approval' %}</li>
</ul>
{% endblock %}

{% block content_title %}
<h1>{% trans 'New user approval' %}</h1>
{% endblock %}

{% block content %}
  {% csrf_token %}
  <div id="new-user-approval" class="g-d-c-fluid">
    <ul>
    {% for user in new_users %}
      <li class="user--{{ user.type }}">
        <span class="user__username">{{ user.username }}</span>
        <span class="user__date-joined">{{ user.date_joined }}</span>
        <span class="user__email">{{ user.email }}</span>
        <span class="user__url">
          <a target="_blank" 
             rel="noopener noreferrer"
             href="{{ user.url }}">
            {{ user.url }}
          </a>
        </span>
        <span class="user__type">{{ user.type }}</span>
        <button class="user__approve" title="Approve user">
          <svg>
            <use xlink:href="#check"></use>
          </svg>
        </button>
        <button class="user__refuse" title="Deny user">
          <svg>
            <use xlink:href="#close"></use>
          </svg>
        </button>
      </li>
    {% empty %}
      <li>{% trans 'No users to add.' %}</li>
    {% endfor %}
    </ul>
  </div>
  {% include 'icons.svg' %}
{# <div class="g-d-c-fluid"> #}
  {# <form action="" method="get"> #}
    {# <fieldset class="grp-module"> #}
      {# <div class="grp-row"> #}
        {# {{ form.as_p }} #}
      {# </div> #}
      {# <div class="grp-row"> #}
        {# <input type="submit" value="{% trans 'Run report' %}" /> #}
      {# </div> #}
    {# </fieldset> #}
  {# </form> #}
{# </div> #}
{#  #}
{# <div class="g-d-c-fluid"> #}
{# <form action="" method="post"> #}
  {# {% csrf_token %} #}
  {# <fieldset class="grp-module"> #}
    {# <div class="grp-row"> #}
      {# <p>{% trans 'Students in group:' %} {{ student_list.count }}</p> #}
      {# <p>{% trans 'Student assignments:' %} {{ student_assignment_list.count }}</p> #}
      {# {% if assignments_created %} #}
      {# <p>{% trans 'Assignments created:' %} {{assignments_created}}</p> #}
      {# <p>{% trans 'Emails sent:' %} {{emails_sent}}</p> #}
      {# {% endif %} #}
    {# </div> #}
    {# <div class="grp-row"> #}
      {# <input type="hidden" name="group_assignment" value="{{ group_assignment.pk }}"> #}
      {# <input type="submit" value="{% trans 'Send all missing' %}" {% if student_list.count == student_assignment_list.count %}disabled{% endif %} /> #}
    {# </div> #}
  {# </fieldset> #}
{# </form> #}
{# </div> #}

{% endblock %}
