{% extends 'peerinst/student/base.html' %}

{% load i18n bleach_html static %}

{% block body %}

<main>
  <section id="student-page">

    <h1 class="mdc-typography--display3">{% trans 'Review Completed Questions' %}
      <svg class="underline" width=150 height=4></svg>
    </h1>
    {% for student_assignment in student_assignments %}
      <h2 class="dc-typography--display1 mdc-theme--secondary">
        {{student_assignment.group_assignment.assignment.title}}
      </h2>
      {% if student_assignment.completed %}
      {% for question in student_assignment.group_assignment.assignment.questions.all %}
      <div class="mdc-card">
        <div class="mdc-typography--title bold m-bot-5">
          {{question.title|bleach_html|safe}}
        </div>

        <div class="mdc-typography--body1">
          {{question.text|bleach_html|safe}}
        </div>

        {% if question.image %}
        <img class="question-image" src="{{ question.image.url }}" alt="{{ question.image_alt_text }}">
        {% endif %}

        {% if question.video_url %}
        <div id="question-video">
          <object class="question-image" width="640" height="390" data="{{ question.video_url }}"></object>
        </div>
        {% endif %}

        <div class="question-answers">
          <ul>
            {% for label, choice in question.get_choices %}
              <li class="dense-list">{{ label }}. {{ choice|bleach_html|safe }}
              {% for answer_choice in question.answerchoice_set.all %}
                {% if forloop.counter == forloop.parentloop.counter %}
                  {% if answer_choice.correct and student_assignment.group_assignment.show_correct_answers %}
                    <i class="check material-icons">check</i>
                  {% endif %}
                {% endif %}
              {% endfor %}
              </li>
            {% endfor %}
          </ul>
        </div>

        <div class="mdc-card__actions">
          <div class="mdc-card__action-buttons grey">
            <div class="mdc-typography--caption">
              <div>
                {% trans 'Discipline' %}: {{question.discipline}}
              </div>
              <div>
                {% trans 'Categories' %}:
                {% for category in question.category.all %}
                {{ category.title|safe }}{% if not forloop.last %}, {% endif %}
                {% empty %}
                {% trans 'Uncategorized' %}
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
      {% empty %}
      <ul>
        <li><strong>Note: </strong>{% trans 'There are currently no questions in this assignment' %}.</li>
      </ul>
      {% endfor %}
      {% else %}
        <ul>
          <li><strong>Note: </strong>{% trans 'You have not yet completed this assignment' %}.</li>
        </ul>
    {% endif %}
    {% endfor %}
  </section>
</main>

<script nonce="{{ request.csp_nonce }}">

</script>

{% endblock %}
