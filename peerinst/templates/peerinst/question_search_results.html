{% load i18n %}

<!-- <ul>
<li class='mdc-typography--caption'>{{ count }} {% trans 'unique results for' %}
<ul>
  {% for s in previous_search_string %}
    <li>- {{ s|safe }}</li>
  {% endfor %}
</ul>
{% trans '. Showing first ' %}{{ n_search_limit }}.</li>

</ul> -->
<h2 class="mdc-typography--display1  mdc-theme--secondary">{% trans 'Results' %}</h2>

{% for search_results_term in search_results %}
  <h3>"{{search_results_term.term}}" ({{ search_results_term.count }})</h3>
  {% for g in search_results_term.questions|dictsortreversed:"answer_count"  %}
  <div class="mdc-card" id="{{g.id}}" discipline="{{g.discipline}}">
    <div class="mdc-typography--title bold">
      {{g.title|safe}}
    </div>
    {% if g.user %}
    <div class="mdc-typography--caption">
      {% trans 'By: '%}{{ g.user.username }}
    </div>
    {% endif %}

    <div class="mdc-typography--body1" style="margin-top:5px;">
      {{g.text|safe}}
    </div>

    {% if g.image %}
      <img class="question-image" src="{{ g.image.url }}" alt="g.image_alt_text">
    {% endif %}

    <div class="question-answers" style="display:none;">
      <ul>
        {% for label, choice in g.get_choices %}
        <li class="mdc-typography--body1">{{ label }}. {{ choice|safe }}</li>
        {% endfor %}
      <ul>
    </div>

    <div class="mdc-card__actions">

      <div class="mdc-card__action-buttons" style="color:grey;">
        <div class="mdc-typography--caption">
          <div>
            {% trans 'Discipline' %}: {{g.discipline}}
          </div>
          <div>
          {% trans 'Categories' %}:
          {% for c in g.category.all %}
          {{ c.title|safe }}{% if not forloop.last %}, {% endif %}
          {% empty %}
          {% trans 'Uncategorized' %}
          {% endfor %}
          </div>
          <div>
          {% trans 'Student answers' %}: {{g.answer_count}}
          </div>
        </div>
      </div>

      <div class="mdc-card__action-icons">
        {% if assignment %}
        <button onclick="ajax.updateAssignmentQuestionList('{% url 'assignment-edit-ajax' %}', '{{ g.id }}', '{{ assignment.identifier }}')" class="material-icons small-button mdc-button mdc-card__action mdc-card__action--button mdc-button--raised">add</button>
        {% else %}
        <form style="display:inline" method="post" action="#{{g.id|slugify}}">
          {% csrf_token %}
          <input type="hidden" name="{{form_field_name}}" value="{{g.pk}}" />
          <input class="material-icons small-button mdc-button mdc-card__action mdc-card__action--button mdc-button--raised" type="submit" value="add" />
        </form>
        {% endif %}
      </div>
    </div>
  </div>
  {% empty %}
  <ul>
    <li><strong>Note:</strong> {% blocktrans %}No search results{% endblocktrans %}.</li>
  </ul>
  {% endfor %}
{% endfor %}
